<html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><!--
* PyWebCopy Engine [version 7.0.1]
* Copyright 2020; Raja Tomar
* File mirrored from [https://kotlinlang.org/docs/debug-flow-with-idea.html]
* At UTC datetime: [2022-04-07 08:50:38.391452]
--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-04-06T17:37:58.946598"><meta name="build-number" content="345">   <link rel="canonical" href="./debug-flow-with-idea.html" data-react-helmet="true">   <meta name="keywords" content="">   <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5P98');</script><script src="static/v3/analytics.js"></script>  <title>Debug Kotlin Flow using IntelliJ IDEA &#8211; tutorial | Kotlin</title>   <link href="static/v3/app.css" rel="stylesheet">   
        
<link rel="icon" href="../assets/images/favicon_v2.svg" type="image/svg+xml">
<link rel="alternate icon" href="../assets/images/favicon_v2.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="57x57" href="../assets/images/apple-touch-icon_v2.png">
<link rel="apple-touch-icon" sizes="72x72" href="../assets/images/apple-touch-icon-72x72_v2.png">
<link rel="apple-touch-icon" sizes="114x114" href="../assets/images/apple-touch-icon-114x114_v2.png">
<link rel="apple-touch-icon" sizes="144x144" href="../assets/images/apple-touch-icon-144x144_v2.png">
        
          <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Debug Kotlin Flow using IntelliJ IDEA &#8211; tutorial | Kotlin"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Kotlin Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://kotlinlang.org/docs/debug-flow-with-idea.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Debug Kotlin Flow using IntelliJ IDEA &#8211; tutorial | Kotlin"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://kotlinlang.org/docs/debug-flow-with-idea.html#webpage", "url": "https://kotlinlang.org/docs/debug-flow-with-idea.html", "name": "Debug Kotlin Flow using IntelliJ IDEA &#8211; tutorial | Kotlin", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://kotlinlang.org/docs#website", "url": "https://kotlinlang.org/docs", "name": "Kotlin Help" }</script><!-- End Schema.org --></head>    <body data-id="debug-flow-with-idea" data-main-title="Debug Kotlin Flow using IntelliJ IDEA &#8211; tutorial" data-article-props='{"seeAlsoStyle":"links"}' data-template="article" data-breadcrumbs="Official libraries///Coroutines (kotlinx.coroutines)" data-edit-url="https://github.com/Kotlin/kotlinx.coroutines/edit/master/docs/topics/debug-flow-with-idea.md">  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Kotlin  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">  </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="debug-flow-with-idea" id="debug-flow-with-idea.md">Debug Kotlin Flow using IntelliJ IDEA &#8211; tutorial</h1><p id="bf15319f">This tutorial demonstrates how to create Kotlin Flow and debug it using IntelliJ IDEA.</p><p id="b7cfe60f">The tutorial assumes you have prior knowledge of the <a href="https://kotlinlang.org/docs/coroutines-guide.html" id="8574e5de">coroutines</a> and <a href="https://kotlinlang.org/docs/flow.html#flows" id="dd1fa7b3">Kotlin Flow</a> concepts.</p><aside data-type="note" class="prompt" data-title="" id="23923147"><p id="23fca78d">Debugging works for <code class="code ">kotlinx-coroutines-core</code> version 1.3.8 or later.</p></aside><section class="chapter"><h2 id="create-a-kotlin-flow" data-toc="debug-flow-with-idea#create-a-kotlin-flow">Create a Kotlin flow</h2><p id="4eadd012">Create a Kotlin <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/flow.html" id="dd8c4ee5" data-external="true" rel="noopener noreferrer">flow</a> with a slow emitter and a slow collector:</p><ol class="list _decimal" id="8cf7f7a9"><li class="list__item" id="426e51ea"><p id="fb6f93e7">Open a Kotlin project in IntelliJ IDEA. If you don't have a project, <a href="https://kotlinlang.org/docs/jvm-get-started.html#create-an-application" id="c48218cf">create one</a>.</p></li><li class="list__item" id="254af374"><p id="fccd7aed">Open the <code class="code ">main.kt</code> file in <code class="code ">src/main/kotlin</code>.</p><p id="4bddfcb5">The <code class="code ">src</code> directory contains Kotlin source files and resources. The <code class="code ">main.kt</code> file contains sample code that will print <code class="code ">Hello World!</code>.</p></li><li class="list__item" id="f994771b"><p id="1946b490">Create the <code class="code ">simple()</code> function that returns a flow of three numbers:</p><ul class="list _ul" id="d61d7929"><li class="list__item" id="914edc13"><p>Use the <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/delay.html" id="52a03327" data-external="true" rel="noopener noreferrer"><code class="code ">delay()</code></a> function to imitate CPU-consuming blocking code. It suspends the coroutine for 100 ms without blocking the thread.</p></li><li class="list__item" id="8686e1a2"><p>Produce the values in the <code class="code ">for</code> loop using the <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/-flow-collector/emit.html" id="288242dc" data-external="true" rel="noopener noreferrer"><code class="code ">emit()</code></a> function.</p></li></ul><div class="code-block" data-lang="kotlin">import kotlinx.coroutines.*
import kotlinx.coroutines.flow.*
import kotlin.system.*

fun simple(): Flow&lt;Int&gt; = flow {
    for (i in 1..3) {
        delay(100)
        emit(i)
    }
}
</div></li><li class="list__item" id="476d3819"><p id="ac8f23c7">Change the code in the <code class="code ">main()</code> function:</p><ul class="list _ul" id="4c799c4"><li class="list__item" id="4363617c"><p>Use the <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/run-blocking.html" id="40ab02ce" data-external="true" rel="noopener noreferrer"><code class="code ">runBlocking()</code></a> block to wrap a coroutine.</p></li><li class="list__item" id="17029ad9"><p>Collect the emitted values using the <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/collect.html" id="fb6f9e3" data-external="true" rel="noopener noreferrer"><code class="code ">collect()</code></a> function.</p></li><li class="list__item" id="37a78a8d"><p>Use the <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/delay.html" id="c65c6ee4" data-external="true" rel="noopener noreferrer"><code class="code ">delay()</code></a> function to imitate CPU-consuming code. It suspends the coroutine for 300 ms without blocking the thread.</p></li><li class="list__item" id="b46b7857"><p>Print the collected value from the flow using the <a href="https://kotlinlang.org/api/latest/jvm/stdlib/stdlib/kotlin.io/println.html" id="63987692" data-external="true" rel="noopener noreferrer"><code class="code ">println()</code></a> function.</p></li></ul><div class="code-block" data-lang="kotlin">fun main() = runBlocking {
    simple()
        .collect { value -&gt;
            delay(300)
            println(value)
        }
}
</div></li><li class="list__item" id="652975b6"><p id="e076447">Build the code by clicking <b id="b024a7b" class="">Build Project</b>.</p><figure class=" " id="485047df"><img alt="Build an application" title="Build an application" src="images/flow-build-project.png" class=" " width="984" height="308"></figure></li></ol></section><section class="chapter"><h2 id="debug-the-coroutine" data-toc="debug-flow-with-idea#debug-the-coroutine">Debug the coroutine</h2><ol class="list _decimal" id="cc2680fb"><li class="list__item" id="aa95f9d5"><p id="212f4e6f">Set a breakpoint at the line where the <code class="code ">emit()</code> function is called:</p><figure class=" " id="37e4169f"><img alt="Build a console application" title="Build a console application" src="images/flow-breakpoint.png" class=" " width="1120" height="846"></figure></li><li class="list__item" id="87e2deaa"><p id="98d838da">Run the code in debug mode by clicking <b id="8c5a10ee" class="">Debug</b> next to the run configuration at the top of the screen.</p><figure class=" " id="90a0575"><img alt="Build a console application" title="Build a console application" src="images/flow-debug-project.png" class=" " width="1158" height="342"></figure><p id="9d405e24">The <b id="816e44d" class="">Debug</b> tool window appears:</p><ul class="list _ul" id="9f0f0591"><li class="list__item" id="1e420f03"><p>The <b id="9bcbcba3" class="">Frames</b> tab contains the call stack.</p></li><li class="list__item" id="9efd76dd"><p>The <b id="854d25b2" class="">Variables</b> tab contains variables in the current context. It tells us that the flow is emitting the first value.</p></li><li class="list__item" id="270d127"><p>The <b id="4ebc4c8e" class="">Coroutines</b> tab contains information on running or suspended coroutines.</p></li></ul><figure class=" " id="1d773db7"><img alt="Debug the coroutine" title="Debug the coroutine" src="images/flow-debug-1.png" class=" " width="2408" height="658"></figure></li><li class="list__item" id="75f4359a"><p id="9a3e65bc">Resume the debugger session by clicking <b id="82c6ed7f" class="">Resume Program</b> in the <b id="d801a243" class="">Debug</b> tool window. The program stops at the same breakpoint.</p><figure class=" " id="5c97f90e"><img alt="Debug the coroutine" title="Debug the coroutine" src="images/flow-resume-debug.png" class=" " width="1288" height="308"></figure><p id="b368615">Now the flow emits the second value.</p><figure class=" " id="620971a2"><img alt="Debug the coroutine" title="Debug the coroutine" src="images/flow-debug-2.png" class=" " width="2408" height="658"></figure></li></ol></section><section class="chapter"><h2 id="add-a-concurrently-running-coroutine" data-toc="debug-flow-with-idea#add-a-concurrently-running-coroutine">Add a concurrently running coroutine</h2><ol class="list _decimal" id="adc11e58"><li class="list__item" id="1d55fb89"><p id="aac776aa">Open the <code class="code ">main.kt</code> file in <code class="code ">src/main/kotlin</code>.</p></li><li class="list__item" id="2f9bc78b"><p id="87404007">Enhance the code to run the emitter and collector concurrently:</p><ul class="list _ul" id="81f867fc"><li class="list__item" id="84dae02c"><p>Add a call to the <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/buffer.html" id="1b1c57f6" data-external="true" rel="noopener noreferrer"><code class="code ">buffer()</code></a> function to run the emitter and collector concurrently. <code class="code ">buffer()</code> stores emitted values and runs the flow collector in a separate coroutine.</p></li></ul><div class="code-block" data-lang="kotlin">fun main() = runBlocking&lt;Unit&gt; {
    simple()
        .buffer()
        .collect { value -&gt;
            delay(300)
            println(value)
        }
}
</div></li><li class="list__item" id="24ddd46d"><p id="420bed54">Build the code by clicking <b id="80ae6e16" class="">Build Project</b>.</p></li></ol></section><section class="chapter"><h2 id="debug-a-kotlin-flow-with-two-coroutines" data-toc="debug-flow-with-idea#debug-a-kotlin-flow-with-two-coroutines">Debug a Kotlin flow with two coroutines</h2><ol class="list _decimal" id="74a8d0fa"><li class="list__item" id="130905a3"><p id="29753cc8">Set a new breakpoint at <code class="code ">println(value)</code>.</p></li><li class="list__item" id="a7752c88"><p id="77a7dfb0">Run the code in debug mode by clicking <b id="8a66d8c0" class="">Debug</b> next to the run configuration at the top of the screen.</p><figure class=" " id="38f02feb"><img alt="Build a console application" title="Build a console application" src="images/flow-debug-3.png" class=" " width="2408" height="658"></figure><p id="4aea5016">The <b id="2f8c8444" class="">Debug</b> tool window appears.</p><p id="3a720d1a">In the <b id="afbe420b" class="">Coroutines</b> tab, you can see that there are two coroutines running concurrently. The flow collector and emitter run in separate coroutines because of the <code class="code ">buffer()</code> function. The <code class="code ">buffer()</code> function buffers emitted values from the flow. The emitter coroutine has the <b id="38a66383" class="">RUNNING</b> status, and the collector coroutine has the <b id="8359f5bf" class="">SUSPENDED</b> status.</p></li><li class="list__item" id="55db8a60"><p id="bfa93c0">Resume the debugger session by clicking <b id="7abfd4eb" class="">Resume Program</b> in the <b id="1e3118b6" class="">Debug</b> tool window.</p><figure class=" " id="4f29c56b"><img alt="Debugging coroutines" title="Debugging coroutines" src="images/flow-debug-4.png" class=" " width="2408" height="658"></figure><p id="6b1a746">Now the collector coroutine has the <b id="192660f9" class="">RUNNING</b> status, while the emitter coroutine has the <b id="9d545da6" class="">SUSPENDED</b> status.</p><p id="3f31f27b">You can dig deeper into each coroutine to debug your code.</p></li></ol></section><div class="last-modified"> Last modified: 04 April 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="https://kotlinlang.org/docs/debug-coroutines-with-idea.html">Debug coroutines using IntelliJ IDEA &#8211; tutorial</a>   <a class="navigation-links__next" href="https://kotlinlang.org/docs/serialization.html">Serialization</a>  </div></article>  </div></section></main></div>  <script src="static/v3/app.js"></script>  </body></html>